## 文件系统

### 文件系统的基本组成

文件系统是操作系统中负责管理持久数据的子系统

每个文件会被分配两个数据结构：
1. 索引节点
2. 目录项

#### 索引节点 （index node）

记录文件的元信息：索引节点编号，文件大小，访问权限，创建时间，修改时间，**数据在磁盘的位置** 等等。 

索引节点是文件的唯一标识，其存储在硬盘中，所以索引节点同样占用磁盘空间。

#### 目录项 （directory entry）

记录文件的名字，**索引节点指针**以及与其他目录项的层级关联关系。多个目录项关联起来，就会形成目录结构

与索引节点不同，**目录项是由内核维护的一个数据结构，不存放于磁盘，而是缓缓存在内存**。

索引节点唯一标识一个文件，目录项记录文件的名，所以目录项和索引节点的关系是多对一。

目录也是文件。普通文件在磁盘里保存文件数据，目录文件在磁盘里保存子目录或文件。

目录项和目录不是一个东西。  
目录是个文件，持久化存储在磁盘，而目录项内核一个数据结构，缓存在内存。

磁盘读写的最小单位是扇区（512B），多个扇区组成一个逻辑块。（Linux中八个扇区为一个逻辑块）

磁盘在格式化时会被分成三个存储区域：
1. 超级块，用来存储文件系统的详细信息（块个数，块大小，空闲块等）
2. 索引节点区（存储索引节点）
3. 数据块区（存储文件或目录数据）

加载进内存的时机：
* 超级块：文件系统挂载时进入内存
* 索引节点区：当文件被访问时进入内存。

### 虚拟文件系统

目标：对用户提供一个统一的接口

位置：用户层与文件系统层的中间层

名称：虚拟文件系统

